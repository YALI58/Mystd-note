一根总线可能包含多条线。

![[Recording 20250821140726.m4a]]
![[计组录音lv6.m4a]]
![[6.1.1+6.1.3_总线概述PT3M24.343S.webp]]
总线是一组能为多个部件分时共享的公共信息传送线路。
共享是指总线上可以挂接多个部件，各个部件之间互相交换的信息都可以通过这组线路分时共享；
分时是指同一时刻只允许有一个部件向总线发送信息，如果系统中有多个部件，则他们只能分时地向总线发送信息。
使用总线是为了解决IO设备和主机之间的链接的灵活性问题。

串行总线与并行总线
串行总线：
优点：只要一根传输线，成本低廉，广泛应用于长距离传输；应用于计算机内部时，可以节省布线空间。
缺点：在数据发送和接收的时候要进行拆卸和装配，要考虑串行-并行转换的问题。

并行总线：
优点：总线的逻辑时序比较简单，电路实现起来比较容易。
缺点：信号线数量多，占用更多的布线空间；远距离传输成本高；由于工作频率较高时，并行的信号线之间会产生严重干扰，对每条线的要求也越高，所以无法持续提升工作频率。

--系统总线--

系统总线是计算机系统内各功能部件（CPU，主存，IO接口）之间相互链接的总线。
按系统总线传输信息内容的不同，可分为3类：数据总线，地址总线和控制总线。
![](https://img.cdn1.vip/i/689ef4eca21f6_1755247852.webp)


# 总线的分类(按总线功能)

1. 片内总线
- 位置：芯片内部
- 功能：CPU芯片内部寄存器与寄存器之间、寄存器与ALU之间的公共连接线

2. 系统总线
- 位置：计算机系统内各功能部件（CPU、主存、I/O接口）之间
- 子分类：
  a) 数据总线
  - 方向：双向传输
  - 功能：传输各功能部件之间的数据信息
  - 位数：与机器字长、存储字长有关
  
  b) 地址总线
  - 方向：单向传输
  - 功能：指示数据所在的主存单元或I/O端口地址
  - 位数：与主存地址空间大小有关
  
  c) 控制总线
  - 功能：传输控制信息，包括CPU控制命令和主存/外设返回的反馈信号

3. 通信总线
- 位置：计算机系统之间或计算机系统与其他系统之间
- 别名：外部总线
- 功能：用于信息传送（如远程通信设备、测试设备）


系统总线的结构
单总线结构：
结构：CPU，主存，IO设备（通过IO接口）都链接在一组总线上，允许IO设备之间，IO设备和CPU之间或IO设备与主存之间直接交换信息。
优点：结构简单，成本低，易于接入新的设备。
缺点：带宽低，负载重，多个部件只能争用唯一的总线，且不支持并发传送操作。
注：单总线并不是指只有一根信号线，系统总线按传送信息的不同可以细分为地址总线，数据总线和控制总线。

双总线结构：
结构：双总线结构有两条总线，一条是主存总线，用于CPU，主存和通道之间进行数据传送；另一条是IO总线，用于多个外部设备与通道之间进行数据传送。
优点：将叫低速的IO设备从单总线上分离出来，实现存储器总线和IO总线分离。
缺点：需要增加通道等硬件设备。

![](https://img.cdn1.vip/i/689ef4ecc73b7_1755247852.webp)
三总线结构：
![](https://img.cdn1.vip/i/689ef4ecbb419_1755247852.webp)


6.1.5总线的性能指标
1.总线的传输周期（总线周期）
一次总线操作所需的时间（包括申请阶段,寻址阶段，传输阶段和结束阶段），通常由若干个总线时钟周期构成。总线周期
![](https://img.cdn1.vip/i/689ef4ece4a10_1755247852.webp)


2.总线时钟周期：
即机器的时钟周期。计算机有一个统一的时钟，以控制整个计算机的各个部件，总线也要受此时钟的控制。

3.总线的工作频率
总线上各种操作的频率，为总线周期的倒数。
若总线周期=N个时钟周期，则总线的工作频率=时钟频率/N。
实际上指一秒内传送几次数据。

4.总线的时钟频率：
即机器的时钟频率，为时钟周期的倒数。若时钟周期为T，则时钟频率为1/T.实际上指一秒内有多少个时钟周期。

5.总线宽度：
又称为总线位宽，它是总线上同时能够传输的数据位数，通常是指数据总线的根数，如32根为32位总线。

6.总线带宽：
可理解为总线的数据传输率，即单位时间内总线上可传输数据的位数，通常用每秒传送信息的字节数来衡量，单位可用字节/秒表示。
总线带宽 =总线工作频率* 总线长度= 总线宽度 / 总线周期
![[计组录音lv6.m4a]]

注：总线带宽是指总线本身所能达到的最高传输速率，在计算实际的有效数据传输率时，要用实际传输的数据量除以耗时。

7.总线复用
总线复用是指一种信号线在不用的时间传输不同的信息。可以使用较少的线传输更多的信息，从而节省了空间和成本。

8.信号线数
地址总线。数据总线和控制总线 3种总线数的总和称为信号线数。![](https://img.cdn1.vip/i/689ef5dd51506_1755248093.webp)

6.2.1 总线操作和定时
# 总线传输的四个阶段

1. 申请分配阶段  
   - 主模块提出总线使用申请  
   - 总线仲裁机构决定使用权分配  
   - 可细分为：传输请求 + 总线仲裁  

2. 寻址阶段  
   - 主模块发出从模块地址及命令  
   - 启动目标从模块  

3. 传输阶段  
   - 主从模块进行数据交换  
   - 支持单向/双向传输  

4. 结束阶段  
   - 主模块撤除总线占用信息  
   - 释放总线使用权  

# 总线定时类型  
1. 同步通信  
   - 特点：统一时钟控制  
   - 协议：同步定时方式  

2. 异步通信  
   - 特点：应答机制，无公共时钟  
   - 协议：异步定时方式  


同步定时方式-读命令

总线控制器采用一个统一的时钟信号来协调发送和接收双方的传送定时关系。
# CPU（主设备）与输入设备（从设备）总线传输时序

1. **T1时刻（地址阶段）**  
   - CPU在时钟上升沿发出目标设备地址信息  
   - 地址信号稳定在总线上

2. **T2时刻（命令阶段）**  
   - CPU在时钟上升沿发出读命令（低电平有效）  
   - 地址匹配的输入设备：  
     ✓ 接收读命令  
     ✓ 启动内部数据准备操作  
   - 硬性时限：必须在T3上升沿前完成数据总线加载

3. **T3时刻（数据传输阶段）**  
   - CPU执行操作：  
     ✓ 采样数据总线信号  
     ✓ 将数据存入内部寄存器  
   - 输入设备需保持数据稳定直至本周期结束

4. **T4时刻（释放阶段）**  
   - CPU在上升沿撤销读命令  
   - 输入设备响应动作：  
     ✓ 停止驱动数据总线  
     ✓ 释放总线控制权  

如果从设备跟不上节奏，在T3给不出数据，就坏了。
同步定时方式：
![](https://img.cdn1.vip/i/689ef5db27eb8_1755248091.webp)
![](https://img.cdn1.vip/i/689ef5db40da9_1755248091.webp)

![](https://img.cdn1.vip/i/689ef5e1a333f_1755248097.webp)
